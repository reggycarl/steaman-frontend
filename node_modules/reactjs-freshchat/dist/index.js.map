{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["import * as React from 'react'\nimport styles from  './styles.module.css';\n\n//need to declare window for typescript stop complaining about fcWidget\ndeclare const window: any;\n\ntype FreshchatInitProps = {\n  token: string;\n  externalId?: string;\n  firstName?: string;\n  lastName?: string;\n  host?: string;\n  restoreId?: string\n  email?: string;\n  phone?: string;\n  phoneCountryCode?: string;\n  config?: any;\n  open?: boolean;\n  tags?: [string];\n  faqTags?: any;\n  locale?: string;\n}\n\nexport interface FreshchatStyles {\n  backgroundColor: string;\n  color: string;\n}\n\nexport interface  FreshChatProps extends FreshchatInitProps {\n  label?: string;\n  ic_styles?: FreshchatStyles;\n}\n\nexport const Freshchat: React.FC<FreshChatProps> =  ({ \n  label,\n  ic_styles,\n  ...rest\n}) => {\n  const [isWidgetOpen, setIsWidgetOpen] = React.useState(false);\n  const UrlIcon = 'https://firebasestorage.googleapis.com/v0/b/repfinder-450e2.appspot.com/o/chat.svg?alt=media&token=885c5d28-2165-4a24-a96c-c1b0c98fab3f'\n  \n  //Inject FreshChat script in the html\n  //oficial doc: https://developers.freshchat.com/web-sdk/#intro\n  const loadScript = () => {\n    let id = 'freshchat-lib'\n    \n    if (document.getElementById(id) || window.fcWidget) return\n    \n    let script = document.createElement('script')\n    script.async = true\n    script.type = 'text/javascript'\n    script.src = 'https://wchat.freshchat.com/js/widget.js'\n    script.id = id\n    document.head.appendChild(script)\n  }\n\n  //Init FreshChat with the data passed in\n  const init = () => {\n      if(label) {\n        if(!rest.config) {\n          rest.config =  {\n            \n          }\n        } else {\n          rest.config = {\n            ...rest.config,\n            headerProperty: {\n              hideChatButton: true\n            }\n          }\n        }\n        \n      }\n\n      if(!rest.host) rest.host = 'https://wchat.freshchat.com'\n\n      window.fcWidget.init({\n        ...rest\n      })\n    \n  }\n\n  const toggleWidget = () => {\n    window.fcWidget.open();\n\n    //hide button\n    setIsWidgetOpen(true)\n    let script = document.createElement('script')\n    script.async = true\n    script.type = 'text/javascript'\n    script.src = `${\n      window.fcWidget.on(\"widget:closed\", function() {\n        //show button\n        setIsWidgetOpen(false)\n      })\n      \n    }`\n    document.head.appendChild(script)\n\n    let script_event = document.createElement('script')\n    script_event.async = true\n    script_event.type = 'text/javascript'\n    script_event.src = `${\n      window.fcWidget.on(\"user:created\", function() {\n        console.log('User has been created');\n        //Function to do some task\n      })\n      \n    }`\n    document.head.appendChild(script_event)\n  }\n\n  React.useEffect(() => {\n    loadScript()\n\n\n    //need check if the FresChat was initalized before try to init the icon\n    let interval = setInterval(() => {\n      if(window.fcWidget) {\n        clearInterval(interval)\n        try {\n          init()\n        } catch (error) {\n          console.log(error)\n        }\n      }\n    }, 1000)\n  })\n\n  return (\n    label ? (\n      !isWidgetOpen ? <div className={styles.buttonContainer} onClick={() => toggleWidget()}>\n        <div \n          className={styles.buttonContent}\n          style={{\n            backgroundColor: ic_styles ? ic_styles.backgroundColor : '#002d85',\n            color: ic_styles ? ic_styles.color : '#ffffff',\n            borderColor: ic_styles ? \n              `transparent ${ic_styles.backgroundColor} transparent transparent` :\n              `transparent #002d85 transparent transparent`\n          }} \n          \n          >\n          <label>{label}</label>\n          <img \n            src={UrlIcon} \n            alt=\"chat icon\"\n            />\n        </div>\n      </div> : null\n   ) : null) \n  \n}"],"names":["Freshchat","label","ic_styles","rest","React","isWidgetOpen","setIsWidgetOpen","UrlIcon","loadScript","id","document","getElementById","window","fcWidget","script","createElement","async","type","src","head","appendChild","init","config","headerProperty","hideChatButton","host","toggleWidget","open","on","script_event","console","log","interval","setInterval","clearInterval","error","className","styles","buttonContainer","onClick","buttonContent","style","backgroundColor","color","borderColor","alt"],"mappings":"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"}